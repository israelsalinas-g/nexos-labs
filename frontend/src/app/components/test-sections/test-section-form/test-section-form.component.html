
    <div class="modal-overlay" (click)="onCancel()">
      <div class="modal-content" (click)="$event.stopPropagation()">
        <div class="modal-header">
          <h2>{{ isEditMode ? 'Editar Sección' : 'Nueva Sección' }}</h2>
          <button class="close-btn" (click)="onCancel()">&times;</button>
        </div>

        <form [formGroup]="sectionForm" (ngSubmit)="onSubmit()">
          <div class="form-body">
            <!-- Nombre -->
            <div class="form-group">
              <label for="name" class="required">Nombre</label>
              <input 
                id="name"
                type="text" 
                formControlName="name"
                class="form-control"
                placeholder="Ej: Química Sanguínea"
                [class.invalid]="isFieldInvalid('name')">
              <div class="error-message" *ngIf="isFieldInvalid('name')">
                <span *ngIf="sectionForm.get('name')?.errors?.['required']">El nombre es requerido</span>
                <span *ngIf="sectionForm.get('name')?.errors?.['minlength']">Mínimo 2 caracteres</span>
                <span *ngIf="sectionForm.get('name')?.errors?.['maxlength']">Máximo 100 caracteres</span>
              </div>
            </div>

            <!-- Código -->
            <div class="form-group">
              <label for="code">Código</label>
              <input 
                id="code"
                type="text" 
                formControlName="code"
                class="form-control"
                placeholder="Ej: QS"
                [class.invalid]="isFieldInvalid('code')">
              <div class="error-message" *ngIf="isFieldInvalid('code')">
                <span *ngIf="sectionForm.get('code')?.errors?.['maxlength']">Máximo 20 caracteres</span>
              </div>
            </div>

            <!-- Descripción -->
            <div class="form-group">
              <label for="description">Descripción</label>
              <textarea 
                id="description"
                formControlName="description"
                class="form-control"
                rows="3"
                placeholder="Descripción de la sección"></textarea>
            </div>

            <!-- Color y Display Order en una fila -->
            <div class="form-row">
              <!-- Color -->
              <div class="form-group">
                <label for="color">Color</label>
                <div class="color-input-wrapper">
                  <input 
                    id="color"
                    type="color" 
                    formControlName="color"
                    class="color-picker">
                  <input 
                    type="text" 
                    formControlName="color"
                    class="form-control color-text"
                    placeholder="#4CAF50"
                    [class.invalid]="isFieldInvalid('color')">
                </div>
                <div class="error-message" *ngIf="isFieldInvalid('color')">
                  <span *ngIf="sectionForm.get('color')?.errors?.['pattern']">
                    Formato inválido. Use #RRGGBB (ej: #4CAF50)
                  </span>
                </div>
              </div>

              <!-- Display Order -->
              <div class="form-group">
                <label for="displayOrder">Orden</label>
                <input 
                  id="displayOrder"
                  type="number" 
                  formControlName="displayOrder"
                  class="form-control"
                  placeholder="0"
                  min="0">
              </div>
            </div>

            <!-- Estado Activo -->
            <div class="form-group checkbox-group">
              <label class="checkbox-label">
                <input 
                  type="checkbox" 
                  formControlName="isActive"
                  class="checkbox-input">
                <span>Sección activa</span>
              </label>
            </div>

            <!-- Mensajes de error generales -->
            <div class="error-message" *ngIf="submitError">
              {{ submitError }}
            </div>

            <!-- Mensaje de éxito -->
            <div class="success-message" *ngIf="submitSuccess">
              {{ submitSuccess }}
            </div>
          </div>

          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" (click)="onCancel()">
              Cancelar
            </button>
            <button type="submit" class="btn btn-primary" [disabled]="sectionForm.invalid || isSubmitting">
              {{ isSubmitting ? 'Guardando...' : (isEditMode ? 'Actualizar' : 'Crear') }}
            </button>
          </div>
        </form>
      </div>
    </div>